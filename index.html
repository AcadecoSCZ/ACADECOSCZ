<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AcadecoSCZ - Plataforma Estudiantil</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .calendar-day {
            min-height: 80px;
            position: relative;
        }
        .calendar-day:hover {
            background-color: #f3f4f6;
        }
        .note-indicator {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 8px;
            height: 8px;
            background-color: #3b82f6;
            border-radius: 50%;
        }
        .task-card {
            transition: all 0.2s ease;
        }
        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .feature-card {
            transition: transform 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <h1 class="text-xl font-bold text-blue-600 cursor-pointer hover:text-blue-700 transition-colors" onclick="goToHome()">📚 AcadecoSCZ</h1>
                </div>
                <div class="flex items-center space-x-4" id="user-header-info">
                    <span class="text-sm text-gray-600" id="header-student-name">Estudiante</span>
                    <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium" id="header-avatar">E</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white border-b" id="main-nav">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex space-x-8">
                <button onclick="showSection('inicio')" class="nav-btn py-4 px-1 border-b-2 border-blue-500 text-blue-600 font-medium text-sm">
                    🏠 Inicio
                </button>
                <button onclick="goToNosotros()" class="nav-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                    ℹ️ Nosotros
                </button>
            </div>
        </div>
    </nav>

    <!-- Academic Navigation (Hidden by default) -->
    <nav class="bg-white border-b hidden" id="academic-nav">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center">
                <div class="flex space-x-8">
                    <button onclick="showSection('progreso')" class="nav-btn py-4 px-1 border-b-2 border-blue-500 text-blue-600 font-medium text-sm">
                        📊 Mi Progreso
                    </button>
                    <button onclick="showSection('tareas')" class="nav-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                        📋 Tareas
                    </button>
                    <button onclick="showSection('calendario')" class="nav-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                        📅 Calendario
                    </button>
                    <button onclick="showSection('focus')" class="nav-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                        🎯 Focus Mode
                    </button>
                    <button onclick="showSection('logros')" class="nav-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                        🏆 Logros
                    </button>
                    <button onclick="showSection('consejos')" class="nav-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                        💡 Consejos
                    </button>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="showSection('perfil')" class="text-gray-500 hover:text-gray-700 font-medium text-sm" id="profile-nav-btn">
                        ⚙️ Perfil
                    </button>
                    <button onclick="logout()" class="text-gray-500 hover:text-gray-700 font-medium text-sm">
                        🚪 Cerrar Sesión
                    </button>
                    <button onclick="goBackToMain()" class="px-3 py-1 text-sm text-gray-600 hover:text-gray-800">
                        ← Volver al inicio
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Inicio Section -->
        <div id="inicio-section" class="section">
            <!-- Hero Section -->
            <div class="hero-gradient rounded-2xl text-white p-12 mb-12 text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-6">Bienvenido a AcadecoSCZ</h1>
                <p class="text-xl md:text-2xl mb-8 opacity-90">Tu plataforma integral para el éxito académico</p>
                <div class="flex justify-center space-x-4">
                    <button type="button" onclick="goToNosotros()" class="group relative px-10 py-4 bg-white text-purple-600 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 overflow-hidden">
                        <span class="absolute inset-0 bg-gradient-to-r from-purple-400 to-pink-400 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></span>
                        <span class="relative z-10 group-hover:text-white transition-colors duration-300 flex items-center">
                            🚀 Comenzar Ahora
                            <svg class="ml-2 w-5 h-5 transform group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                            </svg>
                        </span>
                    </button>
                    <button type="button" onclick="enterAcademicMode()" class="group relative px-8 py-4 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 overflow-hidden">
                        <span class="absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></span>
                        <span class="relative z-10 flex items-center">
                            📚 Acceso Directo
                            <svg class="ml-2 w-5 h-5 transform group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </span>
                    </button>
                </div>
            </div>

            <!-- Features Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                <div class="feature-card bg-white rounded-xl shadow-sm border p-8 text-center">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <span class="text-3xl">📊</span>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">Seguimiento de Progreso</h3>
                    <p class="text-gray-600">Monitorea tu rendimiento académico y estadísticas de estudio por materia</p>
                </div>

                <div class="feature-card bg-white rounded-xl shadow-sm border p-8 text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <span class="text-3xl">📋</span>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">Gestión de Tareas</h3>
                    <p class="text-gray-600">Organiza tus tareas, adjunta archivos y mantén el control de tus entregas</p>
                </div>

                <div class="feature-card bg-white rounded-xl shadow-sm border p-8 text-center">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <span class="text-3xl">📅</span>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">Calendario Académico</h3>
                    <p class="text-gray-600">Planifica tus actividades y mantén anotaciones importantes en cada día</p>
                </div>
            </div>

        </div>

        <!-- Nosotros Section -->
        <div id="nosotros-section" class="section hidden">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold text-gray-900 mb-4">Bienvenido a AcadecoSCZ</h2>
                    <div class="w-24 h-1 bg-blue-600 mx-auto"></div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border p-8 md:p-12">
                    <div class="prose prose-lg max-w-none text-gray-700 leading-relaxed">
                        <p class="mb-6">
                            En la actualidad, uno de los mayores retos para los estudiantes es mantener un buen rendimiento académico frente a las distracciones constantes de los dispositivos móviles y las redes sociales. La falta de organización en la gestión de tareas, exámenes y actividades extracurriculares se ha convertido en una de las principales causas de bajo desempeño escolar.
                        </p>
                        
                        <p class="mb-6">
                            Consciente de esta realidad, AcadecoSCZ nace como una herramienta tecnológica diseñada para ayudarte a organizar tu vida académica de manera eficiente. A través de nuestra aplicación móvil y página web, ofrecemos un espacio intuitivo y funcional que te permitirá planificar tus actividades, recibir recordatorios personalizados y, al mismo tiempo, fomentar un uso responsable del tiempo.
                        </p>
                        
                        <p class="mb-6">
                            Nuestro objetivo es claro: apoyarte en la construcción de hábitos de estudio más organizados, mejorar tu rendimiento escolar y minimizar las distracciones digitales. Además, ponemos a tu disposición estadísticas e información personalizada que te ayudarán a reflexionar sobre tu propio uso de la tecnología y a encontrar un equilibrio entre estudio y ocio.
                        </p>
                        
                        <p class="mb-8">
                            En AcadecoSCZ, creemos que la tecnología debe ser un aliado en tu aprendizaje, no un obstáculo.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-12">
                        <div class="text-center p-6 bg-blue-50 rounded-xl">
                            <div class="text-4xl mb-4">🎯</div>
                            <h3 class="text-xl font-semibold mb-2">Nuestra Misión</h3>
                            <p class="text-gray-600">Transformar la manera en que los estudiantes organizan su vida académica mediante tecnología intuitiva</p>
                        </div>
                        <div class="text-center p-6 bg-green-50 rounded-xl">
                            <div class="text-4xl mb-4">🌟</div>
                            <h3 class="text-xl font-semibold mb-2">Nuestra Visión</h3>
                            <p class="text-gray-600">Ser la plataforma líder en organización académica que impulse el éxito estudiantil</p>
                        </div>
                    </div>

                    <!-- Contact Section -->
                    <div class="mt-12 pt-8 border-t border-gray-200">
                        <h3 class="text-2xl font-bold text-center text-gray-900 mb-8">Contáctanos</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8 max-w-4xl mx-auto">
                            <!-- Instagram -->
                            <div class="text-center p-8 bg-gradient-to-br from-purple-100 to-pink-100 rounded-xl">
                                <div class="text-5xl mb-4">📷</div>
                                <h4 class="text-xl font-semibold mb-3">Instagram</h4>
                                <p class="text-gray-600 mb-4">Síguenos para contenido educativo</p>
                                <a href="https://www.instagram.com/acadecoscz/" target="_blank" rel="noopener noreferrer" class="inline-block px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg font-medium hover:from-purple-600 hover:to-pink-600 transition-colors">
                                    @acadecoscz
                                </a>
                            </div>

                            <!-- Phone Support -->
                            <div class="text-center p-8 bg-green-50 rounded-xl">
                                <div class="text-5xl mb-4">📞</div>
                                <h4 class="text-xl font-semibold mb-3">Soporte Telefónico</h4>
                                <p class="text-gray-600 mb-4">Quejas y reclamos</p>
                                <a href="tel:+59178585730" class="inline-block px-6 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors">
                                    +591 78585730
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="text-center mt-8">
                        <button onclick="showAuthModal()" class="px-8 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                            Acceder a la Plataforma
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mi Progreso Section -->
        <div id="progreso-section" class="section hidden">
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">Mi Progreso Académico</h2>
                <p class="text-gray-600 mb-6">Revisa tu rendimiento y estadísticas de estudio</p>
                
                <!-- Toggle Introduction Button -->
                <div class="mb-6">
                    <button onclick="toggleProgressIntro()" id="progress-intro-toggle-btn" class="flex items-center px-4 py-2 bg-blue-100 text-blue-800 rounded-lg hover:bg-blue-200 transition-colors">
                        <span id="progress-intro-toggle-icon">📊</span>
                        <span class="ml-2" id="progress-intro-toggle-text">Ver introducción al seguimiento de progreso</span>
                    </button>
                </div>
                
                <!-- Complete Introduction to Progress System -->
                <div id="progress-intro" class="hidden space-y-6 mb-8">
                    <!-- What is progress tracking -->
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100">
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <span class="text-2xl">📊</span>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-blue-900 mb-2">¿Qué es el seguimiento de progreso?</h3>
                                <p class="text-blue-800 leading-relaxed mb-3">
                                    El seguimiento de progreso te permite <strong>visualizar tu rendimiento académico</strong> de manera clara y organizada. 
                                    Aquí puedes ver estadísticas detalladas sobre tus tareas, materias y hábitos de estudio.
                                </p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                                    <div class="bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="font-semibold text-blue-900 mb-1">📈 Estadísticas Generales</div>
                                        <div class="text-sm text-blue-700">Resumen completo de tu actividad académica</div>
                                    </div>
                                    <div class="bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="font-semibold text-blue-900 mb-1">📚 Progreso por Materia</div>
                                        <div class="text-sm text-blue-700">Rendimiento específico en cada asignatura</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- How statistics work -->
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100">
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <span class="text-2xl">🔢</span>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-green-900 mb-2">¿Cómo funcionan las estadísticas?</h3>
                                <p class="text-green-800 leading-relaxed mb-4">
                                    Las estadísticas se actualizan automáticamente cada vez que interactúas con la plataforma. 
                                    <strong>No necesitas hacer nada especial</strong>, solo usar AcadecoSCZ normalmente.
                                </p>
                                <div class="space-y-3">
                                    <div class="flex items-start bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-xl mr-3 mt-1">✅</span>
                                        <div>
                                            <div class="font-medium text-green-900">Tareas Completadas</div>
                                            <div class="text-sm text-green-700">Se cuentan automáticamente cuando marcas una tarea como terminada</div>
                                        </div>
                                    </div>
                                    <div class="flex items-start bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-xl mr-3 mt-1">📝</span>
                                        <div>
                                            <div class="font-medium text-green-900">Anotaciones del Calendario</div>
                                            <div class="text-sm text-green-700">Cada recordatorio que agregas suma al total</div>
                                        </div>
                                    </div>
                                    <div class="flex items-start bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-xl mr-3 mt-1">📊</span>
                                        <div>
                                            <div class="font-medium text-green-900">Progreso por Materia</div>
                                            <div class="text-sm text-green-700">Porcentaje calculado según tareas completadas vs. totales</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Benefits of tracking -->
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-100">
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <span class="text-2xl">🎯</span>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-purple-900 mb-2">¿Por qué es importante hacer seguimiento?</h3>
                                <p class="text-purple-800 leading-relaxed mb-3">
                                    Hacer seguimiento de tu progreso te ayuda a <strong>identificar patrones</strong>, 
                                    celebrar logros y detectar áreas que necesitan más atención.
                                </p>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                    <div class="text-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="text-2xl mb-2">📈</div>
                                        <div class="font-medium text-purple-900">Visualiza tu Crecimiento</div>
                                        <div class="text-xs text-purple-700">Ve cómo mejoras con el tiempo</div>
                                    </div>
                                    <div class="text-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="text-2xl mb-2">🎯</div>
                                        <div class="font-medium text-purple-900">Identifica Fortalezas</div>
                                        <div class="text-xs text-purple-700">Descubre en qué materias destacas</div>
                                    </div>
                                    <div class="text-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="text-2xl mb-2">⚡</div>
                                        <div class="font-medium text-purple-900">Mejora Estrategias</div>
                                        <div class="text-xs text-purple-700">Ajusta tu método de estudio</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Getting started -->
                    <div class="bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl p-6 border border-orange-100">
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <span class="text-2xl">🚀</span>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-orange-900 mb-2">¿Cómo empezar?</h3>
                                <p class="text-orange-800 leading-relaxed mb-4">
                                    ¡Es muy fácil! Solo comienza a usar las diferentes secciones de AcadecoSCZ y 
                                    <strong>tu progreso se registrará automáticamente</strong>.
                                </p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <div class="flex items-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-2xl mr-3">📋</span>
                                        <div>
                                            <div class="font-medium text-orange-900">1. Crea tus primeras tareas</div>
                                            <div class="text-sm text-orange-700">Ve a la sección "Tareas" y agrega actividades</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-2xl mr-3">✅</span>
                                        <div>
                                            <div class="font-medium text-orange-900">2. Marca tareas como completadas</div>
                                            <div class="text-sm text-orange-700">Haz clic en el checkbox cuando termines</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-2xl mr-3">📅</span>
                                        <div>
                                            <div class="font-medium text-orange-900">3. Usa el calendario</div>
                                            <div class="text-sm text-orange-700">Agrega recordatorios y fechas importantes</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-2xl mr-3">📊</span>
                                        <div>
                                            <div class="font-medium text-orange-900">4. Revisa tu progreso</div>
                                            <div class="text-sm text-orange-700">Vuelve aquí para ver tus estadísticas</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="bg-white rounded-xl shadow-sm border p-8 mb-8">
                <h3 class="text-xl font-bold text-center mb-8">Estadísticas Generales</h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="text-center">
                        <div class="text-3xl font-bold text-blue-600" id="total-tasks-progress">0</div>
                        <div class="text-gray-600">Tareas Totales</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-green-600" id="completed-tasks-progress">0</div>
                        <div class="text-gray-600">Completadas</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-purple-600" id="total-notes-progress">0</div>
                        <div class="text-gray-600">Anotaciones</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-orange-600">3</div>
                        <div class="text-gray-600">Materias Activas</div>
                    </div>
                </div>
            </div>

            <!-- Progress by Subject -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white rounded-xl shadow-sm border p-6">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                            <span class="text-2xl">🔢</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold">Matemáticas</h3>
                            <p class="text-sm text-gray-500">Progreso general</p>
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="flex justify-between text-sm">
                            <span>Tareas completadas</span>
                            <span id="math-progress">0/0</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-blue-600 h-2 rounded-full" style="width: 0%" id="math-bar"></div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm border p-6">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mr-4">
                            <span class="text-2xl">📖</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold">Lenguaje</h3>
                            <p class="text-sm text-gray-500">Progreso general</p>
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="flex justify-between text-sm">
                            <span>Tareas completadas</span>
                            <span id="lang-progress">0/0</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-600 h-2 rounded-full" style="width: 0%" id="lang-bar"></div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm border p-6">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mr-4">
                            <span class="text-2xl">🧪</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold">Química</h3>
                            <p class="text-sm text-gray-500">Progreso general</p>
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="flex justify-between text-sm">
                            <span>Tareas completadas</span>
                            <span id="chem-progress">0/0</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-purple-600 h-2 rounded-full" style="width: 0%" id="chem-bar"></div>
                        </div>
                    </div>
                </div>
            </div>


        </div>

        <!-- Perfil Section -->
        <div id="perfil-section" class="section hidden">
            <div class="max-w-2xl mx-auto">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Mi Perfil</h2>
                    <p class="text-gray-600">Personaliza tu información académica</p>
                </div>

                <div class="bg-white rounded-xl shadow-sm border p-8">
                    <div class="text-center mb-8">
                        <div class="w-24 h-24 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl text-white font-bold" id="profile-avatar">E</span>
                        </div>
                        <h3 class="text-xl font-semibold" id="profile-display-name">Estudiante</h3>
                        <p class="text-gray-500" id="profile-display-info">Información del perfil</p>
                    </div>

                    <form id="profile-form" class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Foto de perfil</label>
                            <div class="flex items-center space-x-4">
                                <div class="w-20 h-20 bg-blue-500 rounded-full flex items-center justify-center overflow-hidden" id="profile-image-preview">
                                    <span class="text-2xl text-white font-bold" id="profile-image-text">E</span>
                                    <img id="profile-image-display" class="w-full h-full object-cover hidden" alt="Foto de perfil">
                                </div>
                                <div>
                                    <input type="file" id="profile-image-input" accept="image/*" class="hidden" onchange="handleProfileImageChange()">
                                    <button type="button" onclick="document.getElementById('profile-image-input').click()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">
                                        Cambiar foto
                                    </button>
                                    <button type="button" onclick="removeProfileImage()" class="px-4 py-2 bg-red-200 text-red-700 rounded-lg hover:bg-red-300 transition-colors ml-2">
                                        Quitar foto
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nombre completo</label>
                            <input type="text" id="student-name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Ingresa tu nombre completo">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Edad</label>
                            <input type="number" id="student-age" min="10" max="25" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Ingresa tu edad">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Curso</label>
                            <select id="student-course" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">Selecciona tu curso</option>
                                <option value="1ro Primaria">1ro Primaria</option>
                                <option value="2do Primaria">2do Primaria</option>
                                <option value="3ro Primaria">3ro Primaria</option>
                                <option value="4to Primaria">4to Primaria</option>
                                <option value="5to Primaria">5to Primaria</option>
                                <option value="6to Primaria">6to Primaria</option>
                                <option value="1ro Secundaria">1ro Secundaria</option>
                                <option value="2do Secundaria">2do Secundaria</option>
                                <option value="3ro Secundaria">3ro Secundaria</option>
                                <option value="4to Secundaria">4to Secundaria</option>
                                <option value="5to Secundaria">5to Secundaria</option>
                                <option value="6to Secundaria">6to Secundaria</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Colegio</label>
                            <input type="text" id="student-school" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nombre de tu colegio">
                        </div>

                        <div class="flex space-x-4">
                            <button type="button" onclick="saveProfile()" class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                                Guardar Cambios
                            </button>
                            <button type="button" onclick="resetProfile()" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-400 transition-colors">
                                Restablecer
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Tareas Section -->
        <div id="tareas-section" class="section hidden">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Mis Tareas</h2>
                    <p class="text-gray-600">Gestiona tus tareas y entregas</p>
                </div>
                <button onclick="showNewTaskForm()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center">
                    ➕ Nueva Tarea
                </button>
            </div>

            <!-- New Task Form -->
            <div id="new-task-form" class="hidden mb-6">
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold mb-4">Crear Nueva Tarea</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Título de la tarea</label>
                            <input type="text" id="task-title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Ej: Ensayo sobre literatura contemporánea">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Descripción</label>
                            <textarea id="task-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Describe los detalles de la tarea..."></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Materia</label>
                            <select id="task-subject" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <!-- Options will be populated dynamically -->
                            </select>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Fecha de entrega</label>
                                <input type="date" id="task-due-date" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Prioridad</label>
                                <select id="task-priority" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="media">🟡 Media</option>
                                    <option value="alta">🔴 Alta</option>
                                    <option value="baja">🟢 Baja</option>
                                </select>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Tipo de actividad</label>
                                <select id="task-type" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="tarea">📝 Tarea</option>
                                    <option value="examen">📋 Examen</option>
                                    <option value="proyecto">🎯 Proyecto</option>
                                    <option value="extracurricular">🎨 Extracurricular</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Recordatorio</label>
                                <select id="task-reminder" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="">Sin recordatorio</option>
                                    <option value="1">1 día antes</option>
                                    <option value="3">3 días antes</option>
                                    <option value="7">1 semana antes</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Archivo adjunto</label>
                            <input type="file" id="task-file" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="createTask()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Crear Tarea</button>
                            <button onclick="hideNewTaskForm()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tasks List -->
            <div id="tasks-container" class="space-y-4">
                <!-- Sample tasks will be populated here -->
            </div>
        </div>

        <!-- Calendario Section -->
        <div id="calendario-section" class="section hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">Calendario Académico</h2>
                <p class="text-gray-600">Haz clic en cualquier día para agregar una anotación</p>
                
                <!-- Calendar Filters -->
                <div class="flex flex-wrap gap-4 mt-4 p-4 bg-gray-50 rounded-lg">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Filtrar por materia:</label>
                        <select id="calendar-filter" onchange="renderCalendar()" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Todas las materias</option>
                            <option value="matematicas">🔢 Matemáticas</option>
                            <option value="lenguaje">📖 Lenguaje</option>
                            <option value="quimica">🧪 Química</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Mostrar:</label>
                        <select id="calendar-type-filter" onchange="renderCalendar()" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="all">Todo</option>
                            <option value="tasks">Solo tareas</option>
                            <option value="notes">Solo recordatorios</option>
                            <option value="exams">Solo exámenes</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button onclick="clearCalendarFilters()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors">
                            Limpiar filtros
                        </button>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-sm border">
                <div class="p-4 border-b flex items-center justify-between">
                    <button onclick="previousMonth()" class="p-2 hover:bg-gray-100 rounded">←</button>
                    <h3 id="calendar-month" class="text-lg font-semibold"></h3>
                    <button onclick="nextMonth()" class="p-2 hover:bg-gray-100 rounded">→</button>
                </div>
                <div class="p-4">
                    <div class="grid grid-cols-7 gap-1 mb-2">
                        <div class="text-center text-sm font-medium text-gray-500 py-2">Dom</div>
                        <div class="text-center text-sm font-medium text-gray-500 py-2">Lun</div>
                        <div class="text-center text-sm font-medium text-gray-500 py-2">Mar</div>
                        <div class="text-center text-sm font-medium text-gray-500 py-2">Mié</div>
                        <div class="text-center text-sm font-medium text-gray-500 py-2">Jue</div>
                        <div class="text-center text-sm font-medium text-gray-500 py-2">Vie</div>
                        <div class="text-center text-sm font-medium text-gray-500 py-2">Sáb</div>
                    </div>
                    <div id="calendar-grid" class="grid grid-cols-7 gap-1">
                        <!-- Calendar days will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Focus Mode Section -->
        <div id="focus-section" class="section hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">Modo Concentración</h2>
                <p class="text-gray-600">Elimina distracciones y mantén el enfoque en tus estudios</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Pomodoro Timer -->
                <div class="bg-white rounded-xl shadow-sm border p-8">
                    <h3 class="text-xl font-semibold mb-6 text-center">⏰ Temporizador Pomodoro</h3>
                    
                    <div class="text-center mb-8">
                        <div class="w-48 h-48 mx-auto bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-6">
                            <div class="text-4xl font-bold text-white" id="timer-display">25:00</div>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="flex justify-center space-x-4">
                                <button onclick="startTimer()" id="start-btn" class="px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors">
                                    ▶️ Iniciar
                                </button>
                                <button onclick="pauseTimer()" id="pause-btn" class="px-6 py-3 bg-yellow-600 text-white rounded-lg font-semibold hover:bg-yellow-700 transition-colors hidden">
                                    ⏸️ Pausar
                                </button>
                                <button onclick="resetTimer()" class="px-6 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors">
                                    🔄 Reiniciar
                                </button>
                            </div>
                            
                            <div class="flex justify-center space-x-4 text-sm">
                                <button onclick="setTimerMode('work')" id="work-mode-btn" class="px-4 py-2 bg-blue-100 text-blue-800 rounded-lg font-medium">
                                    📚 Estudio (25min)
                                </button>
                                <button onclick="setTimerMode('break')" id="break-mode-btn" class="px-4 py-2 bg-gray-100 text-gray-600 rounded-lg font-medium">
                                    ☕ Descanso (5min)
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Session Stats -->
                    <div class="border-t pt-6">
                        <h4 class="font-semibold mb-4">📊 Estadísticas de la sesión</h4>
                        <div class="grid grid-cols-2 gap-4 text-center">
                            <div>
                                <div class="text-2xl font-bold text-blue-600" id="completed-pomodoros">0</div>
                                <div class="text-sm text-gray-600">Pomodoros completados</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-green-600" id="total-study-time">0h 0m</div>
                                <div class="text-sm text-gray-600">Tiempo total de estudio</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Custom Timer Form -->
                <div id="custom-timer-form" class="hidden bg-white rounded-xl shadow-sm border p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4">Crear Tiempo Personalizado</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nombre del tiempo</label>
                            <input type="text" id="custom-timer-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Ej: Lectura profunda">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Emoji</label>
                            <input type="text" id="custom-timer-emoji" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="📖" maxlength="2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Duración (minutos)</label>
                            <input type="number" id="custom-timer-minutes" min="1" max="120" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="30">
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="createCustomTimer()" class="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700">Crear</button>
                            <button onclick="hideCustomTimerForm()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">Cancelar</button>
                        </div>
                    </div>
                </div>

                <!-- Focus Settings -->
                <div class="space-y-6">
                    <!-- Ambient Sounds -->
                    <div class="bg-white rounded-xl shadow-sm border p-6">
                        <h3 class="text-lg font-semibold mb-4">🎵 Sonidos Ambientales</h3>
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="playAmbientSound('rain')" class="p-4 bg-blue-50 hover:bg-blue-100 rounded-lg text-center transition-colors">
                                🌧️ Lluvia
                            </button>
                            <button onclick="playAmbientSound('forest')" class="p-4 bg-green-50 hover:bg-green-100 rounded-lg text-center transition-colors">
                                🌲 Bosque
                            </button>
                            <button onclick="playAmbientSound('ocean')" class="p-4 bg-cyan-50 hover:bg-cyan-100 rounded-lg text-center transition-colors">
                                🌊 Océano
                            </button>
                            <button onclick="playAmbientSound('silence')" class="p-4 bg-gray-50 hover:bg-gray-100 rounded-lg text-center transition-colors">
                                🔇 Silencio
                            </button>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Volumen</label>
                            <input type="range" id="volume-slider" min="0" max="100" value="50" class="w-full">
                        </div>
                    </div>

                    <!-- Focus Goals -->
                    <div class="bg-white rounded-xl shadow-sm border p-6">
                        <h3 class="text-lg font-semibold mb-4">🎯 Meta de Estudio</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Materia de enfoque</label>
                                <select id="focus-subject" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="">Seleccionar materia</option>
                                    <option value="matematicas">🔢 Matemáticas</option>
                                    <option value="lenguaje">📖 Lenguaje</option>
                                    <option value="quimica">🧪 Química</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Meta de tiempo (minutos)</label>
                                <input type="number" id="focus-goal" min="15" max="240" value="50" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div class="bg-gray-50 rounded-lg p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium">Progreso de la meta</span>
                                    <span class="text-sm text-gray-600" id="goal-progress-text">0 / 50 min</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%" id="goal-progress-bar"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logros Section -->
        <div id="logros-section" class="section hidden">
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">Sistema de Logros</h2>
                <p class="text-gray-600 mb-6">Celebra tus éxitos académicos y mantén la motivación alta</p>
                
                <!-- Toggle Introduction Button -->
                <div class="mb-6">
                    <button onclick="toggleAchievementIntro()" id="intro-toggle-btn" class="flex items-center px-4 py-2 bg-blue-100 text-blue-800 rounded-lg hover:bg-blue-200 transition-colors">
                        <span id="intro-toggle-icon">📖</span>
                        <span class="ml-2" id="intro-toggle-text">Ver introducción al sistema de logros</span>
                    </button>
                </div>
                
                <!-- Complete Introduction to Achievement System -->
                <div id="achievement-intro" class="hidden space-y-6">
                    <!-- What are achievements -->
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-100">
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <span class="text-2xl">🏆</span>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-purple-900 mb-2">¿Qué son los logros?</h3>
                                <p class="text-purple-800 leading-relaxed mb-3">
                                    Los logros son <strong>reconocimientos especiales</strong> que obtienes al completar actividades específicas en tu vida académica. 
                                    Cada logro representa un hito importante en tu desarrollo como estudiante y te motiva a seguir mejorando.
                                </p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                                    <div class="bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="font-semibold text-purple-900 mb-1">📚 Logros Académicos</div>
                                        <div class="text-sm text-purple-700">Por completar tareas, exámenes y proyectos</div>
                                    </div>
                                    <div class="bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="font-semibold text-purple-900 mb-1">⚡ Logros de Productividad</div>
                                        <div class="text-sm text-purple-700">Por usar técnicas de estudio y concentración</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- How to earn points -->
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100">
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <span class="text-2xl">💎</span>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-blue-900 mb-2">¿Cómo ganar puntos?</h3>
                                <p class="text-blue-800 leading-relaxed mb-4">
                                    Los puntos se ganan automáticamente cuando realizas actividades en AcadecoSCZ. 
                                    <strong>Cada acción cuenta</strong> y te acerca más a desbloquear nuevos logros.
                                </p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <div class="flex items-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-2xl mr-3">✅</span>
                                        <div>
                                            <div class="font-medium text-blue-900">Completar tareas</div>
                                            <div class="text-sm text-blue-700">+5-15 puntos cada una</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-2xl mr-3">⏰</span>
                                        <div>
                                            <div class="font-medium text-blue-900">Sesiones de estudio</div>
                                            <div class="text-sm text-blue-700">+10-25 puntos por sesión</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-2xl mr-3">🏆</span>
                                        <div>
                                            <div class="font-medium text-blue-900">Desbloquear logros</div>
                                            <div class="text-sm text-blue-700">+10-100 puntos extra</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-2xl mr-3">📅</span>
                                        <div>
                                            <div class="font-medium text-blue-900">Usar el calendario</div>
                                            <div class="text-sm text-blue-700">+5 puntos por recordatorio</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- How achievements work -->
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100">
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <span class="text-2xl">🎯</span>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-green-900 mb-2">¿Cómo funcionan los logros?</h3>
                                <p class="text-green-800 leading-relaxed mb-4">
                                    Los logros se desbloquean automáticamente cuando cumples ciertos requisitos. 
                                    <strong>No necesitas hacer nada especial</strong>, solo usar AcadecoSCZ normalmente.
                                </p>
                                <div class="space-y-3">
                                    <div class="flex items-start bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-xl mr-3 mt-1">🔒</span>
                                        <div>
                                            <div class="font-medium text-green-900">Logros Bloqueados</div>
                                            <div class="text-sm text-green-700">Aparecen en gris y muestran qué necesitas hacer para desbloquearlos</div>
                                        </div>
                                    </div>
                                    <div class="flex items-start bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-xl mr-3 mt-1">🌟</span>
                                        <div>
                                            <div class="font-medium text-green-900">Logros Desbloqueados</div>
                                            <div class="text-sm text-green-700">Aparecen a todo color y suman puntos a tu total</div>
                                        </div>
                                    </div>
                                    <div class="flex items-start bg-white bg-opacity-50 rounded-lg p-3">
                                        <span class="text-xl mr-3 mt-1">🎉</span>
                                        <div>
                                            <div class="font-medium text-green-900">Notificación de Logro</div>
                                            <div class="text-sm text-green-700">Recibes una notificación cuando desbloqueas un nuevo logro</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Motivation section -->
                    <div class="bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl p-6 border border-orange-100">
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <span class="text-2xl">💪</span>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-orange-900 mb-2">¿Por qué son importantes?</h3>
                                <p class="text-orange-800 leading-relaxed mb-3">
                                    Los logros y puntos no son solo números. Son una forma de <strong>reconocer tu esfuerzo</strong> 
                                    y mantenerte motivado en tu camino académico.
                                </p>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                    <div class="text-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="text-2xl mb-2">📈</div>
                                        <div class="font-medium text-orange-900">Progreso Visible</div>
                                        <div class="text-xs text-orange-700">Ve tu crecimiento día a día</div>
                                    </div>
                                    <div class="text-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="text-2xl mb-2">🎯</div>
                                        <div class="font-medium text-orange-900">Metas Claras</div>
                                        <div class="text-xs text-orange-700">Objetivos específicos que alcanzar</div>
                                    </div>
                                    <div class="text-center bg-white bg-opacity-50 rounded-lg p-3">
                                        <div class="text-2xl mb-2">🌟</div>
                                        <div class="font-medium text-orange-900">Motivación Extra</div>
                                        <div class="text-xs text-orange-700">Razones para seguir estudiando</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Overview -->
            <div class="bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl text-white p-8 mb-8">
                <div class="text-center">
                    <h3 class="text-2xl font-bold mb-4">🏆 Tu Progreso General</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <div class="text-3xl font-bold" id="total-achievements">0</div>
                            <div class="text-purple-100">Logros Desbloqueados</div>
                        </div>
                        <div>
                            <div class="text-3xl font-bold" id="current-streak">0</div>
                            <div class="text-purple-100">Días Consecutivos</div>
                        </div>
                        <div>
                            <div class="text-3xl font-bold" id="total-points">0</div>
                            <div class="text-purple-100">Puntos Totales</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Achievement Categories -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Academic Achievements -->
                <div class="bg-white rounded-xl shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-6 flex items-center">
                        📚 Logros Académicos
                    </h3>
                    <div class="space-y-4" id="academic-achievements">
                        <!-- Achievements will be populated here -->
                    </div>
                </div>

                <!-- Productivity Achievements -->
                <div class="bg-white rounded-xl shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-6 flex items-center">
                        ⚡ Logros de Productividad
                    </h3>
                    <div class="space-y-4" id="productivity-achievements">
                        <!-- Achievements will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Weekly Challenge -->
            <div class="mt-8 bg-white rounded-xl shadow-sm border p-6">
                <h3 class="text-xl font-semibold mb-4 flex items-center">
                    🎯 Desafío Semanal
                </h3>
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h4 class="font-semibold text-lg" id="weekly-challenge-title">Semana Productiva</h4>
                            <p class="text-gray-600" id="weekly-challenge-desc">Completa 5 sesiones de estudio esta semana</p>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-blue-600" id="weekly-progress">0/5</div>
                            <div class="text-sm text-gray-500">Progreso</div>
                        </div>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div class="bg-gradient-to-r from-blue-500 to-indigo-500 h-3 rounded-full transition-all duration-500" style="width: 0%" id="weekly-progress-bar"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Consejos Section -->
        <div id="consejos-section" class="section hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">Consejos Educativos</h2>
                <p class="text-gray-600">Mejora tus hábitos de estudio y productividad</p>
            </div>

            <!-- AI Personalized Tips -->
            <div class="bg-gradient-to-r from-green-500 to-teal-500 rounded-xl text-white p-8 mb-8">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center mr-4">
                        <span class="text-2xl">🤖</span>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold">Consejo Personalizado IA</h3>
                        <p class="text-green-100">Basado en tu actividad reciente</p>
                    </div>
                </div>
                <div class="bg-white bg-opacity-10 rounded-lg p-4">
                    <p class="text-lg" id="ai-tip">Cargando consejo personalizado...</p>
                </div>
                <button onclick="generateNewTip()" class="mt-4 px-6 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg font-semibold transition-colors">
                    🔄 Nuevo consejo
                </button>
            </div>

            <!-- Tips Categories -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <button onclick="showTipsCategory('study')" class="p-6 bg-white rounded-xl shadow-sm border hover:shadow-md transition-shadow text-left">
                    <div class="text-3xl mb-3">📚</div>
                    <h3 class="text-lg font-semibold mb-2">Hábitos de Estudio</h3>
                    <p class="text-gray-600 text-sm">Técnicas efectivas para mejorar tu aprendizaje</p>
                </button>
                
                <button onclick="showTipsCategory('time')" class="p-6 bg-white rounded-xl shadow-sm border hover:shadow-md transition-shadow text-left">
                    <div class="text-3xl mb-3">⏰</div>
                    <h3 class="text-lg font-semibold mb-2">Gestión del Tiempo</h3>
                    <p class="text-gray-600 text-sm">Organiza tu tiempo de manera eficiente</p>
                </button>
                
                <button onclick="showTipsCategory('focus')" class="p-6 bg-white rounded-xl shadow-sm border hover:shadow-md transition-shadow text-left">
                    <div class="text-3xl mb-3">🎯</div>
                    <h3 class="text-lg font-semibold mb-2">Concentración</h3>
                    <p class="text-gray-600 text-sm">Mantén el foco y elimina distracciones</p>
                </button>
                
                <button onclick="showTipsCategory('phone')" class="p-6 bg-white rounded-xl shadow-sm border hover:shadow-md transition-shadow text-left">
                    <div class="text-3xl mb-3">📱</div>
                    <h3 class="text-lg font-semibold mb-2">Uso del Celular</h3>
                    <p class="text-gray-600 text-sm">Controla el uso de dispositivos móviles</p>
                </button>
                
                <button onclick="showTipsCategory('wellness')" class="p-6 bg-white rounded-xl shadow-sm border hover:shadow-md transition-shadow text-left">
                    <div class="text-3xl mb-3">🧘</div>
                    <h3 class="text-lg font-semibold mb-2">Bienestar</h3>
                    <p class="text-gray-600 text-sm">Técnicas de relajación y manejo del estrés</p>
                </button>
                
                <button onclick="showTipsCategory('motivation')" class="p-6 bg-white rounded-xl shadow-sm border hover:shadow-md transition-shadow text-left">
                    <div class="text-3xl mb-3">💪</div>
                    <h3 class="text-lg font-semibold mb-2">Motivación</h3>
                    <p class="text-gray-600 text-sm">Mantén la motivación y alcanza tus metas</p>
                </button>
            </div>

            <!-- Tips Content Area -->
            <div id="tips-content" class="bg-white rounded-xl shadow-sm border p-8">
                <div class="text-center py-12">
                    <div class="text-6xl mb-4">💡</div>
                    <h3 class="text-xl font-semibold mb-2">Selecciona una categoría</h3>
                    <p class="text-gray-600">Elige una categoría arriba para ver consejos específicos</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Auth Modal -->
    <div id="auth-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 w-96 max-w-90vw">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">Acceso a AcadecoSCZ</h2>
                <p class="text-gray-600">Inicia sesión o crea una cuenta para continuar</p>
            </div>

            <!-- Login/Register Toggle -->
            <div class="flex mb-6 bg-gray-100 rounded-lg p-1">
                <button id="login-tab" onclick="switchAuthTab('login')" class="flex-1 py-2 px-4 text-sm font-medium rounded-md bg-white text-blue-600 shadow-sm">
                    Iniciar Sesión
                </button>
                <button id="register-tab" onclick="switchAuthTab('register')" class="flex-1 py-2 px-4 text-sm font-medium rounded-md text-gray-500 hover:text-gray-700">
                    Crear Cuenta
                </button>
            </div>

            <!-- Login Form -->
            <div id="login-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Correo electrónico</label>
                    <input type="email" id="login-email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="tu@email.com">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Contraseña</label>
                    <input type="password" id="login-password" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Mínimo 5 caracteres">
                </div>
                <div class="flex justify-end space-x-3 mt-6">
                    <button onclick="closeAuthModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">
                        Cancelar
                    </button>
                    <button onclick="handleLogin()" class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                        Iniciar Sesión
                    </button>
                </div>
            </div>

            <!-- Register Form -->
            <div id="register-form" class="hidden space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Correo electrónico</label>
                    <input type="email" id="register-email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="tu@email.com">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Contraseña</label>
                    <input type="password" id="register-password" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Entre 5 y 10 caracteres" maxlength="10">
                    <div class="text-xs text-gray-500 mt-1">La contraseña debe tener entre 5 y 10 caracteres</div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Confirmar contraseña</label>
                    <input type="password" id="register-confirm-password" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Repite tu contraseña" maxlength="10">
                </div>
                <div class="flex justify-end space-x-3 mt-6">
                    <button onclick="closeAuthModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">
                        Cancelar
                    </button>
                    <button onclick="handleRegister()" class="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">
                        Crear Cuenta
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Note Modal -->
    <div id="note-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-96 max-w-90vw max-h-90vh overflow-y-auto">
            <h3 class="text-lg font-semibold mb-4">Recordatorios para <span id="note-date"></span></h3>
            
            <!-- Existing Notes List -->
            <div id="existing-notes" class="mb-6">
                <!-- Existing notes will be populated here -->
            </div>
            
            <!-- New Note Form -->
            <div class="border-t pt-4">
                <h4 class="text-md font-medium mb-3">Agregar nuevo recordatorio</h4>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descripción del recordatorio</label>
                        <textarea id="note-text" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Ej: Examen de álgebra, Entrega de ensayo..."></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Hora del recordatorio</label>
                        <input type="time" id="note-time" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Materia</label>
                        <select id="note-subject" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Sin materia específica</option>
                            <!-- Options will be populated dynamically -->
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeNoteModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">Cerrar</button>
                <button onclick="addNote()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Agregar</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentSection = 'inicio';
        let currentDate = new Date();
        let selectedDay = null;
        let tasks = [];
        let notes = {}; // Now stores arrays of notes per day
        let taskIdCounter = 1;
        let isAcademicMode = false;
        let studentProfile = {
            name: '',
            age: '',
            course: '',
            school: '',
            profileImage: null
        };
        let userAccounts = {}; // Store user accounts
        let currentUser = null;

        // Focus Mode variables
        let timerInterval = null;
        let timerSeconds = 1500; // 25 minutes default
        let isTimerRunning = false;
        let currentTimerMode = 'work'; // 'work' or 'break'
        let completedPomodoros = 0;
        let totalStudyTime = 0;
        let currentAmbientSound = null;
        let notificationsSilenced = false;

        // Achievement system
        let achievements = {
            academic: [
                { id: 'first_task', name: 'Primera Tarea', desc: 'Completa tu primera tarea', icon: '📝', unlocked: false, points: 10 },
                { id: 'task_master', name: 'Maestro de Tareas', desc: 'Completa 10 tareas', icon: '🎯', unlocked: false, points: 50 },
                { id: 'perfect_week', name: 'Semana Perfecta', desc: 'Completa todas las tareas de la semana', icon: '⭐', unlocked: false, points: 100 },
                { id: 'exam_ace', name: 'As de Exámenes', desc: 'Registra 5 exámenes', icon: '🏆', unlocked: false, points: 75 }
            ],
            productivity: [
                { id: 'first_pomodoro', name: 'Primer Pomodoro', desc: 'Completa tu primera sesión de 25 minutos', icon: '⏰', unlocked: false, points: 15 },
                { id: 'focus_master', name: 'Maestro del Enfoque', desc: 'Completa 20 pomodoros', icon: '🎯', unlocked: false, points: 80 },
                { id: 'early_bird', name: 'Madrugador', desc: 'Estudia antes de las 8 AM', icon: '🌅', unlocked: false, points: 25 },
                { id: 'night_owl', name: 'Búho Nocturno', desc: 'Estudia después de las 10 PM', icon: '🦉', unlocked: false, points: 25 }
            ]
        };

        // Tips database
        let tipsDatabase = {
            study: [
                "Usa la técnica Feynman: explica el tema como si se lo enseñaras a un niño de 5 años.",
                "Crea mapas mentales para conectar conceptos y mejorar la comprensión.",
                "Estudia en sesiones de 25-30 minutos con descansos de 5 minutos.",
                "Enseña lo que aprendes a otros para reforzar tu conocimiento.",
                "Usa técnicas de memorización como acrónimos y rimas.",
                "Revisa tus apuntes dentro de las 24 horas para mejorar la retención."
            ],
            time: [
                "Usa la matriz de Eisenhower: urgente vs importante para priorizar tareas.",
                "Planifica tu día la noche anterior para empezar con claridad.",
                "Agrupa tareas similares para aprovechar el momentum mental.",
                "Establece límites de tiempo para cada actividad (timeboxing).",
                "Identifica tus horas más productivas y úsalas para tareas difíciles.",
                "Usa la regla 2-2-2: 2 minutos para decidir, 2 horas para tareas importantes, 2 días para proyectos grandes."
            ],
            focus: [
                "Elimina notificaciones durante el estudio para mantener la concentración.",
                "Usa música instrumental o sonidos de la naturaleza para concentrarte.",
                "Practica la técnica Pomodoro: 25 minutos de trabajo, 5 de descanso.",
                "Crea un espacio de estudio libre de distracciones.",
                "Usa la regla de los 2 minutos: si algo toma menos de 2 minutos, hazlo ahora.",
                "Practica mindfulness para mejorar tu capacidad de concentración."
            ],
            phone: [
                "Pon tu teléfono en modo avión durante las sesiones de estudio.",
                "Usa apps que bloqueen redes sociales durante horas de estudio.",
                "Coloca el teléfono en otra habitación mientras estudias.",
                "Establece horarios específicos para revisar mensajes y redes sociales.",
                "Usa la función 'No molestar' durante las horas de sueño.",
                "Revisa el tiempo de pantalla semanalmente y establece límites."
            ],
            wellness: [
                "Practica la respiración 4-7-8: inhala 4, mantén 7, exhala 8 segundos.",
                "Toma descansos cada hora para estirar y relajar los ojos.",
                "Mantén una postura correcta mientras estudias para evitar dolores.",
                "Practica ejercicios de relajación muscular progresiva.",
                "Medita 10 minutos al día para reducir el estrés.",
                "Mantén un horario de sueño regular para mejorar la concentración."
            ],
            motivation: [
                "Celebra los pequeños logros para mantener la motivación alta.",
                "Visualiza tus metas académicas y el éxito que quieres alcanzar.",
                "Rodéate de personas que apoyen tus objetivos académicos.",
                "Recuerda por qué empezaste cuando sientas ganas de rendirte.",
                "Establece recompensas para cuando completes tareas importantes.",
                "Mantén un diario de gratitud para enfocarte en lo positivo."
            ]
        };

        // Default subjects configuration
        const defaultSubjects = {
            matematicas: {
                name: 'Matemáticas',
                description: 'Álgebra, geometría y cálculo',
                emoji: '🔢',
                bgColor: 'bg-blue-100',
                isDefault: true
            },
            lenguaje: {
                name: 'Lenguaje',
                description: 'Literatura y gramática',
                emoji: '📖',
                bgColor: 'bg-green-100',
                isDefault: true
            },
            quimica: {
                name: 'Química',
                description: 'Química orgánica e inorgánica',
                emoji: '🧪',
                bgColor: 'bg-purple-100',
                isDefault: true
            }
        };

        // Initialize empty tasks array
        tasks = [];

        // Navigation functions
        function showSection(section) {
            // Check if user is trying to access profile without being logged in
            if (section === 'perfil' && !currentUser) {
                showNotification('Debes iniciar sesión para acceder al perfil', 'warning');
                showAuthModal();
                return;
            }
            
            // Hide all sections
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(section + '-section').classList.remove('hidden');
            
            // Update navigation based on current mode
            const navSelector = isAcademicMode ? '#academic-nav .nav-btn' : '#main-nav .nav-btn';
            document.querySelectorAll(navSelector).forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            if (event && event.target) {
                event.target.classList.remove('border-transparent', 'text-gray-500');
                event.target.classList.add('border-blue-500', 'text-blue-600');
            }
            
            currentSection = section;
            
            // Initialize section-specific content
            if (section === 'calendario') {
                renderCalendar();
            } else if (section === 'tareas') {
                renderTasks();
            } else if (section === 'progreso') {
                updateProgressStats();
            } else if (section === 'perfil') {
                loadProfile();
            }
        }

        // Authentication functions
        function showAuthModal() {
            document.getElementById('auth-modal').classList.remove('hidden');
            switchAuthTab('login'); // Default to login tab
        }

        function closeAuthModal() {
            document.getElementById('auth-modal').classList.add('hidden');
            // Clear all form fields
            document.getElementById('login-email').value = '';
            document.getElementById('login-password').value = '';
            document.getElementById('register-email').value = '';
            document.getElementById('register-password').value = '';
            document.getElementById('register-confirm-password').value = '';
        }

        function switchAuthTab(tab) {
            const loginTab = document.getElementById('login-tab');
            const registerTab = document.getElementById('register-tab');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');

            if (tab === 'login') {
                loginTab.className = 'flex-1 py-2 px-4 text-sm font-medium rounded-md bg-white text-blue-600 shadow-sm';
                registerTab.className = 'flex-1 py-2 px-4 text-sm font-medium rounded-md text-gray-500 hover:text-gray-700';
                loginForm.classList.remove('hidden');
                registerForm.classList.add('hidden');
            } else {
                registerTab.className = 'flex-1 py-2 px-4 text-sm font-medium rounded-md bg-white text-green-600 shadow-sm';
                loginTab.className = 'flex-1 py-2 px-4 text-sm font-medium rounded-md text-gray-500 hover:text-gray-700';
                registerForm.classList.remove('hidden');
                loginForm.classList.add('hidden');
            }
        }

        function validateEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function validatePassword(password) {
            return password.length >= 5 && password.length <= 10;
        }

        function handleRegister() {
            const email = document.getElementById('register-email').value.trim();
            const password = document.getElementById('register-password').value;
            const confirmPassword = document.getElementById('register-confirm-password').value;

            // Validation
            if (!email) {
                alert('Por favor ingresa tu correo electrónico');
                return;
            }

            if (!validateEmail(email)) {
                alert('Por favor ingresa un correo electrónico válido');
                return;
            }

            if (!password) {
                alert('Por favor ingresa una contraseña');
                return;
            }

            if (!validatePassword(password)) {
                alert('La contraseña debe tener entre 5 y 10 caracteres');
                return;
            }

            if (password !== confirmPassword) {
                alert('Las contraseñas no coinciden');
                return;
            }

            // Check if user already exists
            if (userAccounts[email]) {
                alert('Ya existe una cuenta con este correo electrónico');
                return;
            }

            // Create new account
            userAccounts[email] = {
                email: email,
                password: password,
                createdAt: new Date()
            };

            alert('¡Cuenta creada exitosamente! Ahora puedes iniciar sesión.');
            switchAuthTab('login');
            document.getElementById('login-email').value = email;
        }

        function handleLogin() {
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;

            // Validation
            if (!email) {
                alert('Por favor ingresa tu correo electrónico');
                return;
            }

            if (!validateEmail(email)) {
                alert('Por favor ingresa un correo electrónico válido');
                return;
            }

            if (!password) {
                alert('Por favor ingresa tu contraseña');
                return;
            }

            if (!validatePassword(password)) {
                alert('La contraseña debe tener entre 5 y 10 caracteres');
                return;
            }

            // Check credentials
            const account = userAccounts[email];
            if (!account) {
                alert('No existe una cuenta con este correo electrónico');
                return;
            }

            if (account.password !== password) {
                alert('Contraseña incorrecta');
                return;
            }

            // Successful login
            currentUser = email;
            closeAuthModal();
            
            // Load user-specific profile data if exists
            loadUserProfile(email);
            
            // Show user header info
            document.getElementById('user-header-info').classList.remove('hidden');
            
            // Enter academic mode after successful login
            isAcademicMode = true;
            document.getElementById('main-nav').classList.add('hidden');
            document.getElementById('academic-nav').classList.remove('hidden');
            showSection('progreso');
            
            showNotification(`¡Bienvenido de vuelta, ${studentProfile.name || 'Estudiante'}!`, 'success');
        }

        function enterAcademicMode() {
            showAuthModal();
            switchAuthTab('login');
        }

        function goBackToMain() {
            isAcademicMode = false;
            document.getElementById('academic-nav').classList.add('hidden');
            document.getElementById('main-nav').classList.remove('hidden');
            showSection('inicio');
        }

        function logout() {
            // Create custom confirmation modal instead of browser confirm
            const confirmModal = document.createElement('div');
            confirmModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            confirmModal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-sm mx-4">
                    <h3 class="text-lg font-semibold mb-4">Cerrar Sesión</h3>
                    <p class="text-gray-600 mb-6">¿Estás seguro de que quieres cerrar sesión?</p>
                    <div class="flex space-x-3 justify-end">
                        <button onclick="this.closest('.fixed').remove()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">
                            Cancelar
                        </button>
                        <button onclick="confirmLogout(); this.closest('.fixed').remove()" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">
                            Cerrar Sesión
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(confirmModal);
        }

        function confirmLogout() {
            currentUser = null;
            isAcademicMode = false;
            document.getElementById('academic-nav').classList.add('hidden');
            document.getElementById('main-nav').classList.remove('hidden');
            showSection('inicio');
            
            // Hide user header info
            document.getElementById('user-header-info').classList.add('hidden');
            
            // Reset header info
            document.getElementById('header-student-name').textContent = 'Estudiante';
            const headerAvatar = document.getElementById('header-avatar');
            headerAvatar.style.backgroundImage = '';
            headerAvatar.textContent = 'E';
            
            // Reset profile data
            studentProfile = {
                name: '',
                age: '',
                course: '',
                school: '',
                profileImage: null
            };
            
            // Clear tasks and notes for security
            tasks = [];
            notes = {};
            
            // Reset progress stats
            updateProgressStats();
            
            showNotification('Sesión cerrada exitosamente', 'info');
        }

        function goToHome() {
            if (isAcademicMode) {
                goBackToMain();
            } else {
                showSection('inicio');
            }
        }

        function goToNosotros() {
            // Hide all sections
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            
            // Show nosotros section
            document.getElementById('nosotros-section').classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('#main-nav .nav-btn').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Highlight nosotros button
            event.target.classList.remove('border-transparent', 'text-gray-500');
            event.target.classList.add('border-blue-500', 'text-blue-600');
            
            currentSection = 'nosotros';
        }

        // Profile functions
        function loadUserProfile(email) {
            // Load user-specific profile data
            if (userAccounts[email] && userAccounts[email].profile) {
                studentProfile = { ...userAccounts[email].profile };
            } else {
                // Initialize empty profile for new user
                studentProfile = {
                    name: '',
                    age: '',
                    course: '',
                    school: '',
                    profileImage: null
                };
            }
            updateProfileDisplay();
            updateHeaderInfo();
        }

        function loadProfile() {
            if (!currentUser) {
                showNotification('Debes iniciar sesión para acceder al perfil', 'warning');
                showAuthModal();
                return;
            }
            
            document.getElementById('student-name').value = studentProfile.name;
            document.getElementById('student-age').value = studentProfile.age;
            document.getElementById('student-course').value = studentProfile.course;
            document.getElementById('student-school').value = studentProfile.school;
            updateProfileDisplay();
            updateProfileImageDisplay();
        }

        function saveProfile() {
            if (!currentUser) {
                showNotification('Debes iniciar sesión para guardar el perfil', 'warning');
                return;
            }
            
            studentProfile.name = document.getElementById('student-name').value.trim();
            studentProfile.age = document.getElementById('student-age').value;
            studentProfile.course = document.getElementById('student-course').value;
            studentProfile.school = document.getElementById('student-school').value.trim();
            
            // Save profile to user account
            if (!userAccounts[currentUser].profile) {
                userAccounts[currentUser].profile = {};
            }
            userAccounts[currentUser].profile = { ...studentProfile };
            
            updateProfileDisplay();
            updateHeaderInfo();
            
            showNotification('¡Perfil guardado exitosamente!', 'success');
        }

        function resetProfile() {
            if (!currentUser) {
                showNotification('Debes iniciar sesión para restablecer el perfil', 'warning');
                return;
            }
            
            if (confirm('¿Estás seguro de que quieres restablecer tu perfil?')) {
                studentProfile = { name: '', age: '', course: '', school: '', profileImage: null };
                
                // Clear profile from user account
                if (userAccounts[currentUser]) {
                    userAccounts[currentUser].profile = { ...studentProfile };
                }
                
                loadProfile();
                updateHeaderInfo();
                showNotification('Perfil restablecido', 'info');
            }
        }

        function handleProfileImageChange() {
            if (!currentUser) {
                showNotification('Debes iniciar sesión para cambiar la foto de perfil', 'warning');
                return;
            }
            
            const fileInput = document.getElementById('profile-image-input');
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    studentProfile.profileImage = e.target.result;
                    
                    // Save to user account
                    if (userAccounts[currentUser] && userAccounts[currentUser].profile) {
                        userAccounts[currentUser].profile.profileImage = e.target.result;
                    }
                    
                    updateProfileImageDisplay();
                    updateHeaderInfo();
                };
                reader.readAsDataURL(file);
            }
        }

        function removeProfileImage() {
            if (!currentUser) {
                showNotification('Debes iniciar sesión para quitar la foto de perfil', 'warning');
                return;
            }
            
            studentProfile.profileImage = null;
            
            // Save to user account
            if (userAccounts[currentUser] && userAccounts[currentUser].profile) {
                userAccounts[currentUser].profile.profileImage = null;
            }
            
            updateProfileImageDisplay();
            updateHeaderInfo();
            document.getElementById('profile-image-input').value = '';
        }

        function updateProfileImageDisplay() {
            const imageDisplay = document.getElementById('profile-image-display');
            const imageText = document.getElementById('profile-image-text');
            const previewImageDisplay = document.getElementById('profile-image-display');
            const previewImageText = document.getElementById('profile-image-text');
            
            if (studentProfile.profileImage) {
                imageDisplay.src = studentProfile.profileImage;
                imageDisplay.classList.remove('hidden');
                imageText.classList.add('hidden');
                previewImageDisplay.src = studentProfile.profileImage;
                previewImageDisplay.classList.remove('hidden');
                previewImageText.classList.add('hidden');
            } else {
                imageDisplay.classList.add('hidden');
                imageText.classList.remove('hidden');
                previewImageDisplay.classList.add('hidden');
                previewImageText.classList.remove('hidden');
                const displayName = studentProfile.name || 'Estudiante';
                imageText.textContent = displayName.charAt(0).toUpperCase();
                previewImageText.textContent = displayName.charAt(0).toUpperCase();
            }
        }

        function updateProfileDisplay() {
            const displayName = studentProfile.name || 'Estudiante';
            const displayInfo = studentProfile.course && studentProfile.school 
                ? `${studentProfile.course} - ${studentProfile.school}`
                : 'Completa tu información del perfil';
            
            document.getElementById('profile-display-name').textContent = displayName;
            document.getElementById('profile-display-info').textContent = displayInfo;
            
            // Update avatar in profile section
            const profileAvatar = document.querySelector('#perfil-section .w-24.h-24');
            if (profileAvatar) {
                const avatarImg = profileAvatar.querySelector('img');
                const avatarText = profileAvatar.querySelector('span');
                
                if (studentProfile.profileImage) {
                    if (!avatarImg) {
                        const img = document.createElement('img');
                        img.className = 'w-full h-full object-cover';
                        img.alt = 'Foto de perfil';
                        profileAvatar.appendChild(img);
                    }
                    profileAvatar.querySelector('img').src = studentProfile.profileImage;
                    profileAvatar.querySelector('img').classList.remove('hidden');
                    if (avatarText) avatarText.classList.add('hidden');
                } else {
                    if (avatarImg) avatarImg.classList.add('hidden');
                    if (avatarText) {
                        avatarText.classList.remove('hidden');
                        avatarText.textContent = displayName.charAt(0).toUpperCase();
                    }
                }
            }
        }

        function updateHeaderInfo() {
            const displayName = studentProfile.name || 'Estudiante';
            document.getElementById('header-student-name').textContent = displayName;
            
            const headerAvatar = document.getElementById('header-avatar');
            if (studentProfile.profileImage) {
                headerAvatar.style.backgroundImage = `url(${studentProfile.profileImage})`;
                headerAvatar.style.backgroundSize = 'cover';
                headerAvatar.style.backgroundPosition = 'center';
                headerAvatar.textContent = '';
            } else {
                headerAvatar.style.backgroundImage = '';
                headerAvatar.textContent = displayName.charAt(0).toUpperCase();
            }
        }

        // Stats update functions
        function updateProgressStats() {
            // General stats
            document.getElementById('total-tasks-progress').textContent = tasks.length;
            document.getElementById('completed-tasks-progress').textContent = tasks.filter(t => t.completed).length;
            
            // Count total notes (sum of all notes arrays)
            let totalNotes = 0;
            Object.values(notes).forEach(dayNotes => {
                if (Array.isArray(dayNotes)) {
                    totalNotes += dayNotes.length;
                } else if (dayNotes) {
                    totalNotes += 1; // Old format compatibility
                }
            });
            document.getElementById('total-notes-progress').textContent = totalNotes;
            
            // Subject-specific progress (only for default subjects in progress view)
            const defaultSubjectKeys = ['matematicas', 'lenguaje', 'quimica'];
            defaultSubjectKeys.forEach(subject => {
                const subjectTasks = tasks.filter(t => t.subject === subject);
                const completedSubjectTasks = subjectTasks.filter(t => t.completed);
                const percentage = subjectTasks.length > 0 ? (completedSubjectTasks.length / subjectTasks.length) * 100 : 0;
                
                const progressText = `${completedSubjectTasks.length}/${subjectTasks.length}`;
                const subjectMap = {
                    'matematicas': 'math',
                    'lenguaje': 'lang',
                    'quimica': 'chem'
                };
                
                document.getElementById(`${subjectMap[subject]}-progress`).textContent = progressText;
                document.getElementById(`${subjectMap[subject]}-bar`).style.width = `${percentage}%`;
            });
        }

        // Task functions
        function updateSubjectSelectors() {
            const taskSelect = document.getElementById('task-subject');
            const noteSelect = document.getElementById('note-subject');
            
            // Clear existing options
            taskSelect.innerHTML = '';
            noteSelect.innerHTML = '<option value="">Sin materia específica</option>';
            
            // Add default subjects
            Object.keys(defaultSubjects).forEach(key => {
                const subject = defaultSubjects[key];
                const taskOption = document.createElement('option');
                taskOption.value = key;
                taskOption.textContent = subject.name;
                taskSelect.appendChild(taskOption);
                
                const noteOption = document.createElement('option');
                noteOption.value = key;
                noteOption.textContent = `${subject.emoji} ${subject.name}`;
                noteSelect.appendChild(noteOption);
            });
        }

        function showNewTaskForm() {
            updateSubjectSelectors();
            document.getElementById('new-task-form').classList.remove('hidden');
        }

        function hideNewTaskForm() {
            document.getElementById('new-task-form').classList.add('hidden');
            // Clear form
            document.getElementById('task-title').value = '';
            document.getElementById('task-description').value = '';
            document.getElementById('task-due-date').value = '';
            document.getElementById('task-file').value = '';
        }

        function createTask() {
            const title = document.getElementById('task-title').value.trim();
            const description = document.getElementById('task-description').value.trim();
            const subject = document.getElementById('task-subject').value;
            const dueDate = document.getElementById('task-due-date').value;
            const priority = document.getElementById('task-priority').value;
            const type = document.getElementById('task-type').value;
            const reminder = document.getElementById('task-reminder').value;
            const fileInput = document.getElementById('task-file');
            
            if (!title) {
                alert('Por favor ingresa un título para la tarea');
                return;
            }
            
            const newTask = {
                id: taskIdCounter++,
                title: title,
                description: description,
                subject: subject,
                priority: priority,
                type: type,
                reminder: reminder,
                fileName: fileInput.files[0] ? fileInput.files[0].name : null,
                completed: false,
                createdAt: new Date(),
                dueDate: dueDate ? new Date(dueDate) : null
            };
            
            tasks.unshift(newTask);
            renderTasks();
            hideNewTaskForm();
            checkAchievements();
            if (isAcademicMode) {
                updateProgressStats();
            }
            // Refresh calendar to show new task due date
            if (currentSection === 'calendario') {
                renderCalendar();
            }
            
            // Show reminder notification if set
            if (reminder && dueDate) {
                showReminderNotification(newTask);
            }
        }

        function renderTasks() {
            const container = document.getElementById('tasks-container');
            container.innerHTML = '';
            
            if (tasks.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-gray-400 text-6xl mb-4">📋</div>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">No hay tareas</h3>
                        <p class="text-gray-500">Crea tu primera tarea haciendo clic en "Nueva Tarea"</p>
                    </div>
                `;
                return;
            }
            
            tasks.forEach(task => {
                // Get subject info from default subjects
                let subjectInfo = defaultSubjects[task.subject];
                if (!subjectInfo) {
                    subjectInfo = { name: 'Materia Desconocida', emoji: '📚', bgColor: 'bg-gray-100' };
                }
                
                const subjectColorClass = `${subjectInfo.bgColor.replace('bg-', 'bg-').replace('-100', '-100')} ${subjectInfo.bgColor.replace('bg-', 'text-').replace('-100', '-800')}`;
                
                // Priority colors and icons
                const priorityConfig = {
                    alta: { color: 'bg-red-100 text-red-800', icon: '🔴' },
                    media: { color: 'bg-yellow-100 text-yellow-800', icon: '🟡' },
                    baja: { color: 'bg-green-100 text-green-800', icon: '🟢' }
                };
                
                // Type icons
                const typeIcons = {
                    tarea: '📝',
                    examen: '📋',
                    proyecto: '🎯',
                    extracurricular: '🎨'
                };
                
                const taskDiv = document.createElement('div');
                taskDiv.className = `task-card bg-white rounded-lg shadow-sm border p-6 ${task.completed ? 'opacity-75' : ''}`;
                taskDiv.innerHTML = `
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3 mb-2">
                                <input type="checkbox" ${task.completed ? 'checked' : ''} 
                                       onchange="toggleTask(${task.id})" 
                                       class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500">
                                <h3 class="text-lg font-semibold ${task.completed ? 'line-through text-gray-500' : 'text-gray-900'}">${task.title}</h3>
                                <span class="px-2 py-1 text-xs font-medium rounded-full ${subjectColorClass}">
                                    ${subjectInfo.emoji} ${subjectInfo.name}
                                </span>
                                ${task.priority ? `<span class="px-2 py-1 text-xs font-medium rounded-full ${priorityConfig[task.priority].color}">
                                    ${priorityConfig[task.priority].icon} ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}
                                </span>` : ''}
                                ${task.type ? `<span class="px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-700">
                                    ${typeIcons[task.type]} ${task.type.charAt(0).toUpperCase() + task.type.slice(1)}
                                </span>` : ''}
                            </div>
                            ${task.description ? `<p class="text-gray-600 mb-3">${task.description}</p>` : ''}
                            ${task.fileName ? `
                                <div class="flex items-center text-sm text-gray-500 mb-2">
                                    <span class="mr-2">📎</span>
                                    <span>${task.fileName}</span>
                                </div>
                            ` : ''}
                            ${task.dueDate ? `
                                <div class="flex items-center text-sm mb-2 ${task.dueDate < new Date() && !task.completed ? 'text-red-600 font-medium' : 'text-orange-600'}">
                                    <span class="mr-2">⏰</span>
                                    <span>Entrega: ${task.dueDate.toLocaleDateString('es-ES')}</span>
                                    ${task.dueDate < new Date() && !task.completed ? '<span class="ml-2 text-red-500">¡Vencida!</span>' : ''}
                                </div>
                            ` : ''}
                            <div class="text-xs text-gray-400">
                                Creada el ${task.createdAt.toLocaleDateString('es-ES')}
                            </div>
                        </div>
                        <button onclick="deleteTask(${task.id})" class="text-gray-400 hover:text-red-500 ml-4">
                            🗑️
                        </button>
                    </div>
                `;
                container.appendChild(taskDiv);
            });
        }

        function toggleTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                renderTasks();
                if (isAcademicMode) {
                    updateProgressStats();
                }
                // Refresh calendar to update task appearance
                if (currentSection === 'calendario') {
                    renderCalendar();
                }
            }
        }

        function deleteTask(taskId) {
            if (confirm('¿Estás seguro de que quieres eliminar esta tarea?')) {
                tasks = tasks.filter(t => t.id !== taskId);
                renderTasks();
                if (isAcademicMode) {
                    updateProgressStats();
                }
                // Refresh calendar to remove task due date
                if (currentSection === 'calendario') {
                    renderCalendar();
                }
            }
        }

        // Calendar functions
        function renderCalendar() {
            const monthNames = [
                'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
            ];
            
            document.getElementById('calendar-month').textContent = 
                `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
            
            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';
            
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            // Get filter values
            const subjectFilter = document.getElementById('calendar-filter')?.value || '';
            const typeFilter = document.getElementById('calendar-type-filter')?.value || 'all';
            
            // Subject colors for calendar days
            const subjectColors = {
                matematicas: 'bg-blue-100 border-blue-300 text-blue-800',
                lenguaje: 'bg-red-100 border-red-300 text-red-800',
                quimica: 'bg-yellow-100 border-yellow-300 text-yellow-800'
            };
            
            for (let i = 0; i < 42; i++) {
                const cellDate = new Date(startDate);
                cellDate.setDate(startDate.getDate() + i);
                
                const dateKey = cellDate.toDateString();
                let dayNotes = notes[dateKey];
                
                // Convert old format to new format
                if (dayNotes && !Array.isArray(dayNotes)) {
                    if (typeof dayNotes === 'string') {
                        dayNotes = [{ text: dayNotes, time: '', subject: '', id: Date.now() }];
                    } else {
                        dayNotes = [{ ...dayNotes, id: Date.now() }];
                    }
                    notes[dateKey] = dayNotes;
                }
                
                // Check for tasks due on this date
                let dueTasks = tasks.filter(task => {
                    if (!task.dueDate) return false;
                    const taskDate = new Date(task.dueDate);
                    return taskDate.toDateString() === cellDate.toDateString();
                });
                
                // Apply filters
                if (subjectFilter) {
                    dueTasks = dueTasks.filter(task => task.subject === subjectFilter);
                    if (dayNotes) {
                        dayNotes = dayNotes.filter(note => note.subject === subjectFilter);
                    }
                }
                
                if (typeFilter !== 'all') {
                    if (typeFilter === 'tasks') {
                        dayNotes = [];
                    } else if (typeFilter === 'notes') {
                        dueTasks = [];
                    } else if (typeFilter === 'exams') {
                        dueTasks = dueTasks.filter(task => task.type === 'examen');
                        dayNotes = [];
                    }
                }
                
                let dayClasses = 'calendar-day border p-2 cursor-pointer ';
                
                if (cellDate.getMonth() !== currentDate.getMonth()) {
                    dayClasses += 'text-gray-400 bg-gray-50 border-gray-200';
                } else if ((dayNotes && dayNotes.length > 0) || dueTasks.length > 0) {
                    // Get unique subjects from all notes and tasks for this day
                    const noteSubjects = dayNotes ? [...new Set(dayNotes.map(note => note.subject).filter(s => s))] : [];
                    const taskSubjects = [...new Set(dueTasks.map(task => task.subject).filter(s => s))];
                    const subjects = [...new Set([...noteSubjects, ...taskSubjects])];
                    
                    if (subjects.length === 1) {
                        // Single subject
                        dayClasses += subjectColors[subjects[0]];
                    } else if (subjects.length > 1) {
                        // Multiple subjects - create gradient effect
                        const gradientColors = subjects.map(subject => {
                            switch(subject) {
                                case 'matematicas': return '#dbeafe'; // blue-100
                                case 'lenguaje': return '#fee2e2'; // red-100
                                case 'quimica': return '#fef3c7'; // yellow-100
                                default: return '#f3f4f6'; // gray-100
                            }
                        });
                        
                        if (gradientColors.length === 2) {
                            dayClasses += `border-gray-400`;
                        } else {
                            dayClasses += `border-gray-400`;
                        }
                    } else {
                        // Notes/tasks without subjects
                        dayClasses += 'bg-gray-100 border-gray-300 hover:bg-gray-150';
                    }
                } else {
                    dayClasses += 'border-gray-200 hover:bg-gray-50';
                }
                
                const dayDiv = document.createElement('div');
                dayDiv.className = dayClasses;
                
                // Apply gradient background for multiple subjects
                const allSubjects = [];
                if (dayNotes && dayNotes.length > 0) {
                    allSubjects.push(...dayNotes.map(note => note.subject).filter(s => s));
                }
                if (dueTasks.length > 0) {
                    allSubjects.push(...dueTasks.map(task => task.subject).filter(s => s));
                }
                const uniqueSubjects = [...new Set(allSubjects)];
                
                if (uniqueSubjects.length > 1) {
                    const gradientColors = uniqueSubjects.map(subject => {
                        switch(subject) {
                            case 'matematicas': return '#dbeafe';
                            case 'lenguaje': return '#fee2e2';
                            case 'quimica': return '#fef3c7';
                            default: return '#f3f4f6';
                        }
                    });
                    
                    if (gradientColors.length === 2) {
                        dayDiv.style.background = `linear-gradient(45deg, ${gradientColors[0]} 50%, ${gradientColors[1]} 50%)`;
                    } else if (gradientColors.length === 3) {
                        dayDiv.style.background = `linear-gradient(120deg, ${gradientColors[0]} 33%, ${gradientColors[1]} 33%, ${gradientColors[1]} 66%, ${gradientColors[2]} 66%)`;
                    }
                }
                
                let displayContent = '';
                
                // Show tasks first (with exclamation mark)
                if (dueTasks.length > 0) {
                    const firstTask = dueTasks[0];
                    const isOverdue = firstTask.dueDate < new Date() && !firstTask.completed;
                    const taskIcon = isOverdue ? '❗' : '❗';
                    
                    const displayText = dueTasks.length > 1 ? 
                        `${firstTask.title.substring(0, 8)}... (+${dueTasks.length - 1})` :
                        `${firstTask.title.substring(0, 12)}${firstTask.title.length > 12 ? '...' : ''}`;
                    
                    displayContent += `
                        <div class="text-xs mt-1 truncate font-bold ${isOverdue ? 'text-red-600' : 'text-orange-600'}">
                            ${taskIcon} ${displayText}
                        </div>
                    `;
                }
                
                // Show notes
                if (dayNotes && dayNotes.length > 0) {
                    const firstNote = dayNotes[0];
                    const timeDisplay = firstNote.time ? ` - ${firstNote.time}` : '';
                    const subjectIcon = firstNote.subject === 'matematicas' ? '🔢' : 
                                       firstNote.subject === 'lenguaje' ? '📖' : 
                                       firstNote.subject === 'quimica' ? '🧪' : '📝';
                    
                    const displayText = dayNotes.length > 1 ? 
                        `${firstNote.text.substring(0, 8)}... (+${dayNotes.length - 1})` :
                        `${firstNote.text.substring(0, 10)}${firstNote.text.length > 10 ? '...' : ''}`;
                    
                    displayContent += `
                        <div class="text-xs mt-1 truncate font-medium">
                            ${subjectIcon} ${displayText}
                        </div>
                        ${timeDisplay ? `<div class="text-xs font-bold">${firstNote.time}</div>` : ''}
                    `;
                }
                
                dayDiv.innerHTML = `
                    <div class="text-sm font-medium">${cellDate.getDate()}</div>
                    ${(dayNotes && dayNotes.length > 0) || dueTasks.length > 0 ? '<div class="note-indicator"></div>' : ''}
                    ${displayContent}
                `;
                
                dayDiv.onclick = () => openNoteModal(cellDate);
                grid.appendChild(dayDiv);
            }
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        }

        function openNoteModal(date) {
            selectedDay = date;
            const dateKey = date.toDateString();
            let dayNotes = notes[dateKey];
            
            // Convert old format to new format if needed
            if (dayNotes && !Array.isArray(dayNotes)) {
                if (typeof dayNotes === 'string') {
                    dayNotes = [{ text: dayNotes, time: '', subject: '', id: Date.now() }];
                } else {
                    dayNotes = [{ ...dayNotes, id: Date.now() }];
                }
                notes[dateKey] = dayNotes;
            }
            
            if (!dayNotes) {
                dayNotes = [];
                notes[dateKey] = dayNotes;
            }
            
            document.getElementById('note-date').textContent = 
                date.toLocaleDateString('es-ES', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            
            // Update subject selector
            updateSubjectSelectors();
            
            // Clear form for new note
            document.getElementById('note-text').value = '';
            document.getElementById('note-time').value = '';
            document.getElementById('note-subject').value = '';
            
            // Display existing notes
            displayExistingNotes(dayNotes);
            
            document.getElementById('note-modal').classList.remove('hidden');
        }

        function displayExistingNotes(dayNotes) {
            const container = document.getElementById('existing-notes');
            container.innerHTML = '';
            
            if (dayNotes.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">No hay recordatorios para este día</p>';
                return;
            }
            
            dayNotes.forEach((note, index) => {
                // Get subject info from default subjects
                let subjectInfo = defaultSubjects[note.subject];
                let subjectIcon = '📝';
                let subjectName = 'Sin materia';
                
                if (subjectInfo) {
                    subjectIcon = subjectInfo.emoji;
                    subjectName = subjectInfo.name;
                }
                
                const noteDiv = document.createElement('div');
                noteDiv.className = 'bg-gray-50 rounded-lg p-3 mb-3 border';
                noteDiv.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-1">
                                <span class="text-lg">${subjectIcon}</span>
                                <span class="text-sm font-medium text-gray-600">${subjectName}</span>
                                ${note.time ? `<span class="text-sm font-bold text-gray-800">${note.time}</span>` : ''}
                            </div>
                            <p class="text-sm text-gray-800">${note.text}</p>
                        </div>
                        <button onclick="removeNote(${index})" class="text-red-500 hover:text-red-700 ml-2 text-sm">
                            🗑️
                        </button>
                    </div>
                `;
                container.appendChild(noteDiv);
            });
        }

        function closeNoteModal() {
            document.getElementById('note-modal').classList.add('hidden');
            selectedDay = null;
        }

        function addNote() {
            if (selectedDay) {
                const noteText = document.getElementById('note-text').value.trim();
                const noteTime = document.getElementById('note-time').value;
                const noteSubject = document.getElementById('note-subject').value;
                const dateKey = selectedDay.toDateString();
                
                if (!noteText) {
                    alert('Por favor ingresa una descripción para el recordatorio');
                    return;
                }
                
                if (!notes[dateKey]) {
                    notes[dateKey] = [];
                }
                
                const newNote = {
                    text: noteText,
                    time: noteTime,
                    subject: noteSubject,
                    id: Date.now()
                };
                
                notes[dateKey].push(newNote);
                
                // Clear form
                document.getElementById('note-text').value = '';
                document.getElementById('note-time').value = '';
                document.getElementById('note-subject').value = '';
                
                // Refresh display
                displayExistingNotes(notes[dateKey]);
                renderCalendar();
                
                if (isAcademicMode) {
                    updateProgressStats();
                }
            }
        }

        function removeNote(noteIndex) {
            if (selectedDay && confirm('¿Estás seguro de que quieres eliminar este recordatorio?')) {
                const dateKey = selectedDay.toDateString();
                let dayNotes = notes[dateKey];
                
                if (dayNotes && Array.isArray(dayNotes) && dayNotes.length > noteIndex) {
                    dayNotes.splice(noteIndex, 1);
                    
                    // Remove the day entry if no notes left
                    if (dayNotes.length === 0) {
                        delete notes[dateKey];
                        dayNotes = [];
                    } else {
                        notes[dateKey] = dayNotes;
                    }
                    
                    // Refresh display
                    displayExistingNotes(dayNotes);
                    renderCalendar();
                    
                    if (isAcademicMode) {
                        updateProgressStats();
                    }
                }
            }
        }

        // Focus Mode Functions
        function startTimer() {
            if (!isTimerRunning) {
                isTimerRunning = true;
                document.getElementById('start-btn').classList.add('hidden');
                document.getElementById('pause-btn').classList.remove('hidden');
                
                timerInterval = setInterval(() => {
                    timerSeconds--;
                    updateTimerDisplay();
                    updateFocusGoalProgress();
                    
                    if (timerSeconds <= 0) {
                        completePomodoro();
                    }
                }, 1000);
            }
        }

        function pauseTimer() {
            if (isTimerRunning) {
                isTimerRunning = false;
                clearInterval(timerInterval);
                document.getElementById('start-btn').classList.remove('hidden');
                document.getElementById('pause-btn').classList.add('hidden');
            }
        }

        function resetTimer() {
            pauseTimer();
            timerSeconds = currentTimerMode === 'work' ? 1500 : 300;
            updateTimerDisplay();
            updateFocusGoalProgress();
        }

        function setTimerMode(timerId) {
            pauseTimer();
            currentTimerId = timerId;
            const timer = customTimers.find(t => t.id === timerId);
            if (timer) {
                timerSeconds = timer.minutes * 60;
                currentTimerMode = timer.id === 'work' ? 'work' : 'break'; // For compatibility
            }
            updateTimerDisplay();
            updateTimerModeButtons();
        }

        function updateTimerModeButtons() {
            const container = document.getElementById('timer-modes');
            container.innerHTML = '';
            
            customTimers.forEach(timer => {
                const button = document.createElement('button');
                button.onclick = () => setTimerMode(timer.id);
                
                const isActive = timer.id === currentTimerId;
                button.className = `px-4 py-2 rounded-lg font-medium transition-colors ${
                    isActive ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                }`;
                
                button.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <span>${timer.emoji}</span>
                        <span>${timer.name} (${timer.minutes}min)</span>
                        ${!timer.isDefault ? '<button onclick="deleteCustomTimer(\'' + timer.id + '\'); event.stopPropagation();" class="ml-2 text-red-500 hover:text-red-700">×</button>' : ''}
                    </div>
                `;
                
                container.appendChild(button);
            });
        }

        function showCustomTimerForm() {
            document.getElementById('custom-timer-form').classList.remove('hidden');
        }

        function hideCustomTimerForm() {
            document.getElementById('custom-timer-form').classList.add('hidden');
            // Clear form
            document.getElementById('custom-timer-name').value = '';
            document.getElementById('custom-timer-emoji').value = '';
            document.getElementById('custom-timer-minutes').value = '';
        }

        function createCustomTimer() {
            const name = document.getElementById('custom-timer-name').value.trim();
            const emoji = document.getElementById('custom-timer-emoji').value.trim();
            const minutes = parseInt(document.getElementById('custom-timer-minutes').value);
            
            if (!name) {
                alert('Por favor ingresa un nombre para el tiempo');
                return;
            }
            
            if (!emoji) {
                alert('Por favor ingresa un emoji');
                return;
            }
            
            if (!minutes || minutes < 1 || minutes > 120) {
                alert('Por favor ingresa una duración válida (1-120 minutos)');
                return;
            }
            
            const newTimer = {
                id: 'custom_' + Date.now(),
                name: name,
                emoji: emoji,
                minutes: minutes,
                isDefault: false
            };
            
            customTimers.push(newTimer);
            updateTimerModeButtons();
            hideCustomTimerForm();
            showNotification(`¡Tiempo personalizado "${name}" creado!`, 'success');
        }

        function deleteCustomTimer(timerId) {
            if (confirm('¿Estás seguro de que quieres eliminar este tiempo personalizado?')) {
                customTimers = customTimers.filter(t => t.id !== timerId);
                
                // If the deleted timer was active, switch to work mode
                if (currentTimerId === timerId) {
                    setTimerMode('work');
                }
                
                updateTimerModeButtons();
                showNotification('Tiempo personalizado eliminado', 'info');
            }
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timerSeconds / 60);
            const seconds = timerSeconds % 60;
            document.getElementById('timer-display').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function completePomodoro() {
            pauseTimer();
            
            if (currentTimerMode === 'work') {
                completedPomodoros++;
                totalStudyTime += 25;
                document.getElementById('completed-pomodoros').textContent = completedPomodoros;
                updateStudyTimeDisplay();
                checkAchievements();
                
                // Auto switch to break
                setTimerMode('break');
                showNotification('¡Pomodoro completado! Tiempo de descanso.', 'success');
            } else {
                // Auto switch back to work
                setTimerMode('work');
                showNotification('¡Descanso terminado! Hora de estudiar.', 'info');
            }
        }

        function updateStudyTimeDisplay() {
            const hours = Math.floor(totalStudyTime / 60);
            const minutes = totalStudyTime % 60;
            document.getElementById('total-study-time').textContent = `${hours}h ${minutes}m`;
        }

        function updateFocusGoalProgress() {
            const goal = parseInt(document.getElementById('focus-goal').value) || 50;
            const progress = Math.min(totalStudyTime, goal);
            const percentage = (progress / goal) * 100;
            
            document.getElementById('goal-progress-text').textContent = `${progress} / ${goal} min`;
            document.getElementById('goal-progress-bar').style.width = `${percentage}%`;
        }

        function playAmbientSound(sound) {
            // Simulate ambient sound selection (no actual audio due to limitations)
            currentAmbientSound = sound;
            
            // Update button states
            document.querySelectorAll('[onclick^="playAmbientSound"]').forEach(btn => {
                btn.className = btn.className.replace('bg-blue-100', 'bg-blue-50')
                                              .replace('bg-green-100', 'bg-green-50')
                                              .replace('bg-cyan-100', 'bg-cyan-50')
                                              .replace('bg-gray-100', 'bg-gray-50');
            });
            
            // Highlight selected sound
            const soundMap = {
                rain: 'bg-blue-100',
                forest: 'bg-green-100', 
                ocean: 'bg-cyan-100',
                silence: 'bg-gray-100'
            };
            
            if (soundMap[sound]) {
                event.target.className = event.target.className.replace(/bg-\w+-50/, soundMap[sound]);
            }
            
            showNotification(`Sonido ambiental: ${sound === 'silence' ? 'Silencio' : sound}`, 'info');
        }

        // Achievement system functions
        function checkAchievements() {
            let newAchievements = [];
            
            // Check academic achievements
            const completedTasks = tasks.filter(t => t.completed).length;
            const examTasks = tasks.filter(t => t.type === 'examen').length;
            
            if (completedTasks >= 1 && !achievements.academic[0].unlocked) {
                achievements.academic[0].unlocked = true;
                newAchievements.push(achievements.academic[0]);
            }
            
            if (completedTasks >= 10 && !achievements.academic[1].unlocked) {
                achievements.academic[1].unlocked = true;
                newAchievements.push(achievements.academic[1]);
            }
            
            if (examTasks >= 5 && !achievements.academic[3].unlocked) {
                achievements.academic[3].unlocked = true;
                newAchievements.push(achievements.academic[3]);
            }
            
            // Check productivity achievements
            if (completedPomodoros >= 1 && !achievements.productivity[0].unlocked) {
                achievements.productivity[0].unlocked = true;
                newAchievements.push(achievements.productivity[0]);
            }
            
            if (completedPomodoros >= 20 && !achievements.productivity[1].unlocked) {
                achievements.productivity[1].unlocked = true;
                newAchievements.push(achievements.productivity[1]);
            }
            
            // Show notifications for new achievements
            newAchievements.forEach(achievement => {
                showNotification(`¡Logro desbloqueado! ${achievement.name}`, 'success');
            });
            
            updateAchievementsDisplay();
        }

        function updateAchievementsDisplay() {
            const academicContainer = document.getElementById('academic-achievements');
            const productivityContainer = document.getElementById('productivity-achievements');
            
            if (academicContainer) {
                academicContainer.innerHTML = '';
                achievements.academic.forEach(achievement => {
                    const achievementDiv = createAchievementElement(achievement);
                    academicContainer.appendChild(achievementDiv);
                });
            }
            
            if (productivityContainer) {
                productivityContainer.innerHTML = '';
                achievements.productivity.forEach(achievement => {
                    const achievementDiv = createAchievementElement(achievement);
                    productivityContainer.appendChild(achievementDiv);
                });
            }
            
            // Update totals
            const totalUnlocked = [...achievements.academic, ...achievements.productivity]
                .filter(a => a.unlocked).length;
            const totalPoints = [...achievements.academic, ...achievements.productivity]
                .filter(a => a.unlocked)
                .reduce((sum, a) => sum + a.points, 0);
            
            if (document.getElementById('total-achievements')) {
                document.getElementById('total-achievements').textContent = totalUnlocked;
            }
            if (document.getElementById('total-points')) {
                document.getElementById('total-points').textContent = totalPoints;
            }
        }

        function createAchievementElement(achievement) {
            const div = document.createElement('div');
            div.className = `flex items-center p-4 rounded-lg border ${
                achievement.unlocked ? 'bg-green-50 border-green-200' : 'bg-gray-50 border-gray-200'
            }`;
            
            div.innerHTML = `
                <div class="text-3xl mr-4 ${achievement.unlocked ? '' : 'grayscale opacity-50'}">${achievement.icon}</div>
                <div class="flex-1">
                    <h4 class="font-semibold ${achievement.unlocked ? 'text-green-900' : 'text-gray-500'}">${achievement.name}</h4>
                    <p class="text-sm ${achievement.unlocked ? 'text-green-700' : 'text-gray-400'}">${achievement.desc}</p>
                    <div class="text-xs font-medium mt-1 ${achievement.unlocked ? 'text-green-600' : 'text-gray-400'}">
                        +${achievement.points} puntos
                    </div>
                </div>
                ${achievement.unlocked ? '<div class="text-green-500 text-xl">✓</div>' : '<div class="text-gray-300 text-xl">🔒</div>'}
            `;
            
            return div;
        }

        // Tips functions
        function generateNewTip() {
            const allTips = Object.values(tipsDatabase).flat();
            const randomTip = allTips[Math.floor(Math.random() * allTips.length)];
            document.getElementById('ai-tip').textContent = randomTip;
        }

        function showTipsCategory(category) {
            const container = document.getElementById('tips-content');
            const categoryTips = tipsDatabase[category] || [];
            
            const categoryNames = {
                study: 'Hábitos de Estudio',
                time: 'Gestión del Tiempo',
                focus: 'Concentración',
                phone: 'Uso del Celular',
                wellness: 'Bienestar',
                motivation: 'Motivación'
            };
            
            const categoryIcons = {
                study: '📚',
                time: '⏰',
                focus: '🎯',
                phone: '📱',
                wellness: '🧘',
                motivation: '💪'
            };
            
            container.innerHTML = `
                <div class="mb-6">
                    <h3 class="text-2xl font-bold text-gray-900 mb-2 flex items-center">
                        <span class="text-3xl mr-3">${categoryIcons[category]}</span>
                        ${categoryNames[category]}
                    </h3>
                    <p class="text-gray-600">Consejos prácticos para mejorar en esta área</p>
                </div>
                <div class="space-y-4">
                    ${categoryTips.map((tip, index) => `
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-100">
                            <div class="flex items-start">
                                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0 text-white font-bold">
                                    ${index + 1}
                                </div>
                                <p class="text-gray-800 leading-relaxed">${tip}</p>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Notification system
        function showNotification(message, type = 'info') {
            if (notificationsSilenced) return;
            
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 translate-x-full`;
            
            const colors = {
                success: 'bg-green-500 text-white',
                error: 'bg-red-500 text-white',
                info: 'bg-blue-500 text-white',
                warning: 'bg-yellow-500 text-black'
            };
            
            notification.className += ` ${colors[type] || colors.info}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        function showReminderNotification(task) {
            const reminderDays = parseInt(task.reminder);
            if (reminderDays && task.dueDate) {
                const reminderDate = new Date(task.dueDate);
                reminderDate.setDate(reminderDate.getDate() - reminderDays);
                
                if (reminderDate <= new Date()) {
                    showNotification(`Recordatorio: ${task.title} vence en ${reminderDays} día(s)`, 'warning');
                }
            }
        }

        function clearCalendarFilters() {
            document.getElementById('calendar-filter').value = '';
            document.getElementById('calendar-type-filter').value = 'all';
            renderCalendar();
        }

        // Achievement intro toggle function
        function toggleAchievementIntro() {
            const intro = document.getElementById('achievement-intro');
            const toggleIcon = document.getElementById('intro-toggle-icon');
            const toggleText = document.getElementById('intro-toggle-text');
            
            if (intro.classList.contains('hidden')) {
                intro.classList.remove('hidden');
                toggleIcon.textContent = '📚';
                toggleText.textContent = 'Ocultar introducción';
            } else {
                intro.classList.add('hidden');
                toggleIcon.textContent = '📖';
                toggleText.textContent = 'Ver introducción al sistema de logros';
            }
        }

        // Progress intro toggle function
        function toggleProgressIntro() {
            const intro = document.getElementById('progress-intro');
            const toggleIcon = document.getElementById('progress-intro-toggle-icon');
            const toggleText = document.getElementById('progress-intro-toggle-text');
            
            if (intro.classList.contains('hidden')) {
                intro.classList.remove('hidden');
                toggleIcon.textContent = '📊';
                toggleText.textContent = 'Ocultar introducción';
            } else {
                intro.classList.add('hidden');
                toggleIcon.textContent = '📊';
                toggleText.textContent = 'Ver introducción al seguimiento de progreso';
            }
        }

        // Initialize the application
        function initializeApp() {
            // Hide user header info by default
            document.getElementById('user-header-info').classList.add('hidden');
            
            // Set default timer display
            updateTimerDisplay();
            updateStudyTimeDisplay();
            updateFocusGoalProgress();
            updateTimerModeButtons();
            
            // Generate initial AI tip
            generateNewTip();
            
            // Update achievements display
            updateAchievementsDisplay();
            
            // Update profile display
            updateProfileDisplay();
            updateHeaderInfo();
            
            // Set minimum date for task due dates to today
            const today = new Date().toISOString().split('T')[0];
            const dueDateInput = document.getElementById('task-due-date');
            if (dueDateInput) {
                dueDateInput.min = today;
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            showSection('inicio');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99003ac5b5f0190e',t:'MTc2MDcwODY1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
            });
